import numpy as np
import moorpy as mp
import yaml
import os
import raft 
import matplotlib.pyplot as plt



water_density = 1025
g = 9.81


# DESIGN VARIABLES #
depth = 200

column_diameter = 15
draft = 60
freeboard = 15
thickness = 0.02
ballast_fill = 40
center_column_shape = 'circ'

pontoon_n = 3
pontoon_dim = 10
pontoon_shape = 'circ'
pontoon_length = 50

tether_n = 6
linetype = 'hmpe'
linelength = 140
d = 120



# DESIGN CREATION
design = {}

design['type'] = 'input file for RAFT'
design['name'] = 'IEA 15 MW with VolturnUS-S steel semi'

## settings
settings = {}
settings['min_freq'] = 0.005
settings['max_freq'] = 0.4
settings['XiStart'] = 0
settings['nIter'] = 10

design['settings'] = settings

## site
site = {}
site['water_depth'] = depth
site['rho_water'] = 1025.0
site['rho_air'] = 1.225
site['mu_air'] = 1.81e-05
site['shearExp'] = 0.12

design['site'] = site

## cases
cases = {}
cases['keys'] = ['wind_speed', 'wind_heading', 'turbulence', 'turbine_status', 'turbine_heading', 'wave_spectrum', 'wave_period', 'wave_height', 'wave_heading', 'current_speed', 'current_heading', 'current_turbulence']
cases['data'] = [[10.0, 0, 0.01, 'operating', 0, 'JONSWAP', 0.0, 0.0, 0.0, 0.0, 0, 0]]

design['cases'] = cases


## TURBINE ##   # (IEA 15 MW Turbine)

nRotor = 1
hHub = 150

turbine = {}

turbine['mRNA'] = 991000
turbine['IxRNA'] = 0
turbine['IrRNA'] = 0
turbine['xCG_RNA'] = 0
turbine['hHub'] = hHub
turbine['Fthrust'] = 1500.0e3

turbine['I_drivetrain'] = 318628138.0

turbine['nBlades'] = 3
turbine['Zhub'] = hHub
turbine['Rhub'] = 3.97
turbine['precone'] = 4.0
turbine['shaft_tilt'] = 6.0
turbine['overhang'] = 12.0313

turbine['aeroServoMod'] = 2

# blade
turbine['blade'] = [{} for _ in range(nRotor)]
turbine['blade'][0]['precurveTip'] = -4.0
turbine['blade'][0]['presweepTip'] = 0.0
turbine['blade'][0]['Rtip'] = 120.96999999936446
turbine['blade'][0]['geometry'] = [[8.004, 5.228, 15.474, 0.035, 0.0], [12.039, 5.321, 14.692, 0.084, 0.0], [16.073, 5.458, 13.33, 0.139, 0.0], [20.108, 5.602, 11.644, 0.192, 0.0], [24.142, 5.718, 9.927, 0.232, 0.0], [28.177, 5.767, 8.438, 0.25, 0.0], [32.211, 5.713, 7.301, 0.25, 0.0], [36.246, 5.536, 6.232, 0.246, 0.0], [40.28, 5.291, 5.23, 0.24, 0.0], [44.315, 5.035, 4.348, 0.233, 0.0], [48.349, 4.815, 3.606, 0.218, 0.0], [52.384, 4.623, 2.978, 0.178, 0.0], [56.418, 4.432, 2.423, 0.1, 0.0], [60.453, 4.245, 1.924, 0.0, 0.0], [64.487, 4.065, 1.467, -0.112, 0.0], [68.522, 3.896, 1.056, -0.244, 0.0], [72.556, 3.735, 0.692, -0.415, 0.0], [76.591, 3.579, 0.355, -0.62, 0.0], [80.625, 3.425, 0.019, -0.846, 0.0], [84.66, 3.268, -0.358, -1.08, 0.0], [88.694, 3.112, -0.834, -1.33, 0.0], [92.729, 2.957, -1.374, -1.602, 0.0], [96.763, 2.8, -1.848, -1.895, 0.0], [100.798, 2.637, -2.136, -2.202, 0.0], [104.832, 2.464, -2.172, -2.523, 0.0], [108.867, 2.283, -2.108, -2.864, 0.0], [112.901, 2.096, -1.953, -3.224, 0.0], [116.936, 1.902, -1.662, -3.605, 0.0]]
turbine['blade'][0]['airfoils'] = [[0.0, 'circular'], [0.02, 'circular'], [0.15, 'SNL-FFA-W3-500'], [0.24517, 'FFA-W3-360'], [0.32884, 'FFA-W3-330blend'], [0.43918, 'FFA-W3-301'], [0.53767, 'FFA-W3-270blend'], [0.63821, 'FFA-W3-241'], [0.77174, 'FFA-W3-211'], [1.0, 'FFA-W3-211']]

# airfoils
turbine['airfoils'] = [{} for _ in range(8)]

turbine['airfoils'][0]['name'] = 'circular'
turbine['airfoils'][0]['relative_thickness'] = 1.0
turbine['airfoils'][0]['data'] = [[-179.9087, 0.0001, 0.35, -0.0001], [179.9087, 0.0001, 0.35, -0.0001]]

turbine['airfoils'][1]['name'] = 'SNL-FFA-W3-500'
turbine['airfoils'][1]['relative_thickness'] = 0.5
turbine['airfoils'][1]['data'] = [[-179.966, 0.0, 0.0844, 0.0], [-170.0, 0.4419, 0.0844, 0.3125], [-160.0002, 0.8837, 0.1268, 0.2831], [-149.9998, 0.9674, 0.2927, 0.2632], [-139.9999, 0.7801, 0.497, 0.2048], [-130.0001, 0.6293, 0.7161, 0.1932], [-120.0003, 0.4785, 0.9246, 0.2008], [-109.9999, 0.3189, 1.0985, 0.2136], [-100.0, 0.1553, 1.2182, 0.2221], [-90.0002, 0.0, 1.2707, 0.2198], [-79.9998, -0.1553, 1.2182, 0.196], [-70.0, -0.3189, 1.0985, 0.1635], [-60.0001, -0.4784, 0.9246, 0.1285], [-49.9997, -0.6293, 0.7161, 0.0965], [-39.9999, -0.7801, 0.497, 0.0716], [-30.0001, -0.9674, 0.2927, 0.0522], [-20.0002, -1.0281, 0.1499, -0.0063], [-19.7499, -1.0243, 0.1472, -0.0089], [-19.2502, -1.0052, 0.1447, -0.0099], [-18.9999, -0.9971, 0.1433, -0.0105], [-18.75, -1.0052, 0.1403, -0.011], [-18.5002, -0.9995, 0.1386, -0.0116], [-18.2499, -0.9908, 0.1373, -0.012], [-18.0, -0.9815, 0.136, -0.0126], [-17.4998, -0.9764, 0.1322, -0.0135], [-17.25, -0.9705, 0.1306, -0.0139], [-17.0002, -0.9655, 0.129, -0.0143], [-16.7498, -0.9662, 0.1268, -0.0147], [-16.5, -0.9544, 0.1258, -0.0151], [-16.2502, -0.9444, 0.1246, -0.0155], [-15.9998, -0.9405, 0.1229, -0.0158], [-15.75, -0.9433, 0.1206, -0.0161], [-15.5002, -0.933, 0.1195, -0.0164], [-15.2498, -0.9211, 0.1185, -0.0168], [-14.7502, -0.9158, 0.115, -0.0173], [-14.4998, -0.907, 0.1138, -0.0175], [-14.25, -0.8959, 0.1127, -0.0178], [-14.0002, -0.8926, 0.111, -0.0181], [-13.7498, -0.8808, 0.11, -0.0184], [-13.5, -0.8722, 0.1089, -0.0186], [-13.2502, -0.866, 0.1075, -0.0188], [-12.9998, -0.8626, 0.1059, -0.0188], [-12.75, -0.8489, 0.1051, -0.0192], [-12.5002, -0.8363, 0.1042, -0.0194], [-12.2498, -0.8363, 0.1023, -0.0194], [-12.0, -0.8271, 0.1013, -0.0196], [-11.7502, -0.8141, 0.1004, -0.0198], [-11.4998, -0.8004, 0.0997, -0.02], [-11.0002, -0.789, 0.0971, -0.0199], [-10.7498, -0.7862, 0.0956, -0.0196], [-10.5, -0.7747, 0.0948, -0.0194], [-10.2502, -0.7701, 0.094, -0.0184], [-9.9998, -0.7674, 0.0925, -0.0183], [-9.75, -0.7506, 0.0917, -0.0192], [-9.5002, -0.729, 0.0912, -0.0205], [-9.2498, -0.7095, 0.0902, -0.0224], [-9.0, -0.6855, 0.0895, -0.0247], [-8.7502, -0.659, 0.0891, -0.0267], [-8.4998, -0.6319, 0.0887, -0.0287], [-8.25, -0.6019, 0.0879, -0.032], [-8.0002, -0.5718, 0.0875, -0.0345], [-7.7498, -0.5424, 0.0873, -0.0367], [-7.5, -0.5098, 0.0868, -0.0399], [-7.2502, -0.4767, 0.0864, -0.043], [-6.9998, -0.4454, 0.0862, -0.0453], [-6.75, -0.4142, 0.086, -0.0476], [-6.5002, -0.3791, 0.0856, -0.051], [-6.2498, -0.346, 0.0853, -0.0538], [-6.0, -0.3144, 0.0852, -0.056], [-5.7502, -0.2817, 0.085, -0.0586], [-5.4998, -0.2461, 0.0847, -0.0619], [-5.25, -0.2133, 0.0846, -0.0644], [-5.0002, -0.1827, 0.0845, -0.0663], [-4.7498, -0.1494, 0.0843, -0.0688], [-4.5, -0.1158, 0.0842, -0.0715], [-4.2502, -0.0837, 0.084, -0.0737], [-3.9998, -0.0529, 0.084, -0.0756], [-3.75, -0.0225, 0.0839, -0.0774], [-3.5002, 0.0089, 0.0838, -0.0793], [-3.2498, 0.0392, 0.0838, -0.0811], [-3.0, 0.0686, 0.0838, -0.0826], [-2.7502, 0.0974, 0.0838, -0.0838], [-2.4998, 0.126, 0.0838, -0.0852], [-2.25, 0.1555, 0.0838, -0.0867], [-2.0002, 0.1853, 0.0838, -0.0883], [-1.7498, 0.2146, 0.0837, -0.0897], [-1.5, 0.243, 0.0837, -0.091], [-1.2502, 0.2713, 0.0838, -0.0921], [-0.9998, 0.3006, 0.0838, -0.0936], [-0.75, 0.3295, 0.0838, -0.0949], [-0.5002, 0.3578, 0.0838, -0.0961], [-0.2498, 0.3857, 0.0838, -0.0972], [0.0, 0.4135, 0.0838, -0.0983], [0.2298, 0.4425, 0.0839, -0.0995], [0.4698, 0.4715, 0.0839, -0.1008], [0.7002, 0.5003, 0.0839, -0.1019], [0.9402, 0.5286, 0.084, -0.1029], [1.17, 0.5567, 0.084, -0.104], [1.3997, 0.585, 0.0841, -0.105], [1.6398, 0.6135, 0.0841, -0.1061], [1.8701, 0.6417, 0.0842, -0.1072], [2.1102, 0.6697, 0.0842, -0.1082], [2.34, 0.6975, 0.0843, -0.1091], [2.5697, 0.7251, 0.0843, -0.11], [2.8098, 0.7528, 0.0844, -0.1109], [3.0401, 0.7807, 0.0845, -0.1119], [3.2802, 0.8083, 0.0846, -0.1128], [3.5099, 0.8358, 0.0846, -0.1137], [3.7403, 0.8631, 0.0847, -0.1146], [3.9798, 0.8902, 0.0847, -0.1153], [4.2101, 0.9173, 0.0848, -0.1161], [4.4502, 0.9444, 0.0849, -0.117], [4.6799, 0.9713, 0.085, -0.1178], [4.9102, 0.9981, 0.0851, -0.1185], [5.1497, 1.0249, 0.0852, -0.1192], [5.3801, 1.0515, 0.0853, -0.1199], [5.6201, 1.0779, 0.0853, -0.1206], [5.8499, 1.1041, 0.0854, -0.1212], [6.0802, 1.1302, 0.0856, -0.1218], [6.3197, 1.156, 0.0857, -0.1224], [6.5501, 1.1818, 0.0858, -0.123], [6.7901, 1.2076, 0.0859, -0.1235], [7.0199, 1.2334, 0.086, -0.124], [7.2502, 1.2589, 0.0861, -0.1245], [7.4903, 1.2841, 0.0862, -0.125], [7.72, 1.3088, 0.0864, -0.1254], [7.9601, 1.3331, 0.0865, -0.1257], [8.1899, 1.357, 0.0867, -0.1259], [8.4202, 1.381, 0.0869, -0.1262], [8.6603, 1.4054, 0.087, -0.1265], [8.89, 1.4295, 0.0871, -0.1267], [9.1198, 1.4531, 0.0873, -0.127], [9.8801, 1.5154, 0.0879, -0.1265], [10.6398, 1.5749, 0.0886, -0.1256], [11.4001, 1.6151, 0.0895, -0.1214], [12.1501, 1.6443, 0.0912, -0.1163], [12.9099, 1.6824, 0.093, -0.1133], [13.6702, 1.7146, 0.0954, -0.1107], [14.4202, 1.7362, 0.0989, -0.108], [15.1799, 1.7627, 0.1024, -0.1063], [15.9403, 1.7706, 0.1076, -0.1042], [16.6903, 1.7639, 0.1144, -0.1025], [17.45, 1.7604, 0.1211, -0.1013], [18.2097, 1.7251, 0.131, -0.1001], [18.9701, 1.7035, 0.1399, -0.0998], [19.7201, 1.6784, 0.1492, -0.1001], [20.4798, 1.6505, 0.1591, -0.1016], [21.2401, 1.6227, 0.1691, -0.1036], [21.9901, 1.6067, 0.1778, -0.1064], [22.7499, 1.5972, 0.1858, -0.1099], [23.5102, 1.5892, 0.1937, -0.1136], [24.2602, 1.5815, 0.2014, -0.118], [25.0199, 1.5563, 0.2135, -0.1249], [25.7802, 1.5272, 0.2267, -0.1325], [26.5302, 1.4982, 0.2399, -0.14], [27.29, 1.4691, 0.2531, -0.1476], [28.0497, 1.4401, 0.2663, -0.1551], [28.81, 1.411, 0.2795, -0.1627], [29.56, 1.382, 0.2927, -0.1703], [30.3198, 1.3622, 0.3078, -0.174], [31.0801, 1.3424, 0.323, -0.1777], [31.8301, 1.3225, 0.3381, -0.1815], [32.5898, 1.3027, 0.3532, -0.1852], [33.3502, 1.2829, 0.3684, -0.1889], [34.1002, 1.2631, 0.3835, -0.1926], [34.8599, 1.2433, 0.3987, -0.1964], [35.6202, 1.2234, 0.4138, -0.2001], [36.38, 1.2036, 0.4289, -0.2039], [37.13, 1.1838, 0.4441, -0.2076], [37.8903, 1.164, 0.4592, -0.2113], [38.65, 1.1442, 0.4743, -0.215], [39.4, 1.1243, 0.4895, -0.2188], [40.1598, 1.1064, 0.5052, -0.2218], [40.9201, 1.0905, 0.5214, -0.2242], [41.6701, 1.0745, 0.5376, -0.2266], [42.4298, 1.0586, 0.5538, -0.2289], [43.1901, 1.0426, 0.5701, -0.2313], [43.9401, 1.0267, 0.5863, -0.2337], [44.6999, 1.0107, 0.6025, -0.2361], [45.4602, 0.9948, 0.6188, -0.2384], [46.2199, 0.9788, 0.635, -0.2408], [46.9699, 0.9628, 0.6512, -0.2432], [47.7302, 0.9469, 0.6675, -0.2455], [48.49, 0.9309, 0.6837, -0.2479], [49.24, 0.915, 0.6999, -0.2503], [49.9997, 0.899, 0.7161, -0.2527], [60.0001, 0.6836, 0.9246, -0.2833], [70.0, 0.4556, 1.0985, -0.3156], [79.9998, 0.2219, 1.2182, -0.3482], [90.0002, 0.0, 1.2707, -0.3773], [100.0, -0.1553, 1.2182, -0.3877], [109.9999, -0.3189, 1.0985, -0.3865], [120.0003, -0.4784, 0.9246, -0.3806], [130.0001, -0.6293, 0.7161, -0.3803], [139.9999, -0.7801, 0.497, -0.4032], [149.9998, -0.9674, 0.2927, -0.4854], [160.0002, -0.8837, 0.1268, -0.5325], [170.0, -0.4418, 0.0844, -0.3906], [179.966, 0.0, 0.0844, 0.0]]

turbine['airfoils'][2]['name'] = 'FFA-W3-211'
turbine['airfoils'][2]['relative_thickness'] = 0.211
turbine['airfoils'][2]['data'] = [[-179.9087, 0.0, 0.02464, 0.0], [-177.7143, 0.05403, 0.02534, 0.09143], [-175.4286, 0.10805, 0.02742, 0.18286], [-173.1429, 0.16208, 0.03088, 0.27429], [-170.8572, 0.2161, 0.0357, 0.36571], [-168.5716, 0.27013, 0.05599, 0.39192], [-166.2857, 0.32415, 0.08143, 0.37898], [-164.0, 0.37818, 0.11112, 0.36605], [-161.7145, 0.4322, 0.14485, 0.35312], [-159.4284, 0.48623, 0.18242, 0.34768], [-157.1428, 0.54025, 0.22359, 0.36471], [-154.8573, 0.59428, 0.2681, 0.38175], [-152.5714, 0.6483, 0.31566, 0.39878], [-150.2857, 0.70233, 0.36597, 0.41581], [-148.0, 0.75635, 0.41871, 0.41955], [-143.8571, 0.73188, 0.51941, 0.42287], [-139.7143, 0.70655, 0.62488, 0.42632], [-135.5714, 0.6776, 0.73293, 0.43163], [-131.4286, 0.64333, 0.8413, 0.43694], [-127.2857, 0.60277, 0.94773, 0.44389], [-123.1429, 0.5555, 1.05001, 0.45171], [-119.0, 0.50156, 1.146, 0.45897], [-114.8571, 0.44131, 1.23371, 0.46448], [-110.7143, 0.37542, 1.31129, 0.46998], [-106.5714, 0.30482, 1.37714, 0.47096], [-102.4286, 0.23063, 1.42988, 0.47101], [-98.2857, 0.15413, 1.46842, 0.46824], [-94.1429, 0.07675, 1.49196, 0.46149], [-90.0, 0.0, 1.5, 0.45474], [-85.8571, -0.07675, 1.49196, 0.44026], [-81.7143, -0.15413, 1.46842, 0.42578], [-77.5714, -0.23063, 1.42988, 0.40821], [-73.4286, -0.30482, 1.37714, 0.38846], [-69.2857, -0.37542, 1.31129, 0.36815], [-65.1429, -0.44131, 1.23371, 0.34519], [-61.0, -0.50156, 1.146, 0.32223], [-56.8571, -0.5555, 1.05001, 0.29864], [-52.7143, -0.60277, 0.94773, 0.27486], [-48.5714, -0.64333, 0.8413, 0.25128], [-44.4286, -0.6776, 0.73293, 0.2281], [-40.2857, -0.70655, 0.62488, 0.20491], [-36.1429, -0.73188, 0.51941, 0.15416], [-32.0, -0.75635, 0.41871, 0.10137], [-28.0, -0.85636, 0.28691, 0.06527], [-24.0, -1.18292, 0.1396, 0.01647], [-20.0, -1.23596, 0.08345, -0.00352], [-18.0, -1.22536, 0.06509, -0.00672], [-16.0, -1.20476, 0.04888, -0.00881], [-14.0, -1.18332, 0.03417, -0.01101], [-12.0, -1.10093, 0.02132, -0.02269], [-10.0, -0.88209, 0.01386, -0.04397], [-8.0, -0.62981, 0.01075, -0.05756], [-6.0, -0.3767, 0.00882, -0.06747], [-4.0, -0.12177, 0.00702, -0.0768], [-2.0, 0.1281, 0.00663, -0.08283], [-1.0, 0.25192, 0.00664, -0.08534], [0.0, 0.37535, 0.0067, -0.08777], [1.0, 0.49828, 0.00681, -0.09011], [2.0, 0.62052, 0.00698, -0.09234], [3.0, 0.742, 0.0072, -0.09447], [4.0, 0.86238, 0.00751, -0.09646], [5.0, 0.98114, 0.00796, -0.09828], [6.0, 1.09662, 0.00872, -0.09977], [7.0, 1.20904, 0.00968, -0.10095], [8.0, 1.3168, 0.01097, -0.10163], [9.0, 1.42209, 0.01227, -0.10207], [10.0, 1.52361, 0.01369, -0.10213], [11.0, 1.61988, 0.01529, -0.10174], [12.0, 1.70937, 0.01717, -0.10087], [13.0, 1.78681, 0.01974, -0.09936], [14.0, 1.8429, 0.02368, -0.0972], [15.0, 1.85313, 0.03094, -0.0941], [16.0, 1.80951, 0.04303, -0.09144], [18.0, 1.66033, 0.0773, -0.09242], [20.0, 1.56152, 0.11202, -0.09871], [24.0, 1.43327, 0.18408, -0.1177], [28.0, 1.29062, 0.27589, -0.14566], [32.0, 1.0805, 0.41871, -0.18266], [36.1429, 1.04554, 0.51941, -0.20913], [40.2857, 1.00936, 0.62488, -0.23534], [44.4286, 0.96801, 0.73293, -0.25784], [48.5714, 0.91904, 0.8413, -0.28035], [52.7143, 0.86109, 0.94773, -0.30163], [56.8571, 0.79357, 1.05001, -0.32226], [61.0, 0.71651, 1.146, -0.34247], [65.1429, 0.63044, 1.23371, -0.36135], [69.2857, 0.53632, 1.31129, -0.38024], [73.4286, 0.43546, 1.37714, -0.39704], [77.5714, 0.32947, 1.42988, -0.41341], [81.7143, 0.22019, 1.46842, -0.42844], [85.8571, 0.10965, 1.49196, -0.44159], [90.0, 0.0, 1.5, -0.45474], [94.1429, -0.07675, 1.49196, -0.46149], [98.2857, -0.15413, 1.46842, -0.46824], [102.4286, -0.23063, 1.42988, -0.47101], [106.5714, -0.30482, 1.37714, -0.47096], [110.7143, -0.37542, 1.31129, -0.46998], [114.8571, -0.44131, 1.23371, -0.46448], [119.0, -0.50156, 1.146, -0.45897], [123.1429, -0.5555, 1.05001, -0.45171], [127.2857, -0.60277, 0.94773, -0.44389], [131.4286, -0.64333, 0.8413, -0.43694], [135.5714, -0.6776, 0.73293, -0.43163], [139.7143, -0.70655, 0.62488, -0.42632], [143.8571, -0.73188, 0.51941, -0.42287], [148.0, -0.75635, 0.41871, -0.41955], [150.2857, -0.70233, 0.36597, -0.41581], [152.5714, -0.6483, 0.31566, -0.39878], [154.8571, -0.59428, 0.2681, -0.38175], [157.1429, -0.54025, 0.22359, -0.36471], [159.4286, -0.48623, 0.18242, -0.34768], [161.7143, -0.4322, 0.14485, -0.37026], [164.0, -0.37818, 0.11112, -0.40605], [166.2857, -0.32415, 0.08143, -0.44184], [168.5714, -0.27013, 0.05599, -0.47763], [170.8571, -0.2161, 0.0357, -0.45714], [173.1429, -0.16208, 0.03088, -0.34286], [175.4286, -0.10805, 0.02742, -0.22857], [177.7143, -0.05403, 0.02534, -0.11429], [179.9087, 0.0, 0.02464, 0.0]]

turbine['airfoils'][3]['name'] = 'FFA-W3-241'
turbine['airfoils'][3]['relative_thickness'] = 0.241
turbine['airfoils'][3]['data'] = [[-179.9087, 0.0, 0.01178, 0.0], [-177.7143, 0.05818, 0.01248, 0.09143], [-175.4286, 0.11636, 0.0146, 0.18286], [-173.1429, 0.17453, 0.01811, 0.27429], [-170.8572, 0.23271, 0.023, 0.36571], [-168.5716, 0.29089, 0.02922, 0.39568], [-166.2857, 0.34907, 0.05382, 0.38876], [-164.0, 0.40725, 0.08379, 0.38184], [-161.7145, 0.46542, 0.11786, 0.37492], [-159.4284, 0.5236, 0.15581, 0.37408], [-157.1428, 0.58178, 0.1974, 0.39148], [-154.8573, 0.63996, 0.24237, 0.40888], [-152.5714, 0.69814, 0.29043, 0.42628], [-150.2857, 0.75631, 0.34128, 0.44368], [-148.0, 0.81449, 0.3946, 0.44537], [-143.8571, 0.77925, 0.49645, 0.44436], [-139.7143, 0.74511, 0.60319, 0.4436], [-135.5714, 0.70881, 0.71263, 0.44609], [-131.4286, 0.66835, 0.82249, 0.44858], [-127.2857, 0.62253, 0.93051, 0.4537], [-123.1429, 0.5708, 1.03447, 0.4602], [-119.0, 0.51307, 1.13222, 0.46633], [-114.8571, 0.44965, 1.22176, 0.4713], [-110.7143, 0.38115, 1.30123, 0.47627], [-106.5714, 0.30846, 1.36903, 0.47705], [-102.4286, 0.23266, 1.42376, 0.47695], [-98.2857, 0.15503, 1.46433, 0.47409], [-94.1429, 0.07698, 1.4899, 0.46732], [-90.0, 0.0, 1.5, 0.46055], [-85.8571, -0.07698, 1.4899, 0.44509], [-81.7143, -0.15503, 1.46433, 0.42964], [-77.5714, -0.23266, 1.42376, 0.41125], [-73.4286, -0.30846, 1.36903, 0.39081], [-69.2857, -0.38115, 1.30123, 0.36988], [-65.1429, -0.44965, 1.22176, 0.34663], [-61.0, -0.51307, 1.13222, 0.32339], [-56.8571, -0.5708, 1.03447, 0.29984], [-52.7143, -0.62253, 0.93051, 0.27618], [-48.5714, -0.66835, 0.82249, 0.2528], [-44.4286, -0.70881, 0.71263, 0.22992], [-40.2857, -0.74511, 0.60319, 0.20705], [-36.1429, -0.77925, 0.49645, 0.14561], [-32.0, -0.81449, 0.3946, 0.08131], [-28.0, -1.07781, 0.22252, 0.04592], [-24.0, -1.12692, 0.15159, 0.01901], [-20.0, -1.1448, 0.09699, 0.00063], [-18.0, -1.12797, 0.07744, -0.00342], [-16.0, -1.09392, 0.06122, -0.00587], [-14.0, -1.05961, 0.04667, -0.00652], [-12.0, -1.03121, 0.03302, -0.00755], [-10.0, -0.93706, 0.02027, -0.02243], [-8.0, -0.6738, 0.01168, -0.05583], [-6.0, -0.40391, 0.00918, -0.07159], [-4.0, -0.14226, 0.00839, -0.08123], [-2.0, 0.1158, 0.0081, -0.08892], [-1.0, 0.24382, 0.00808, -0.09235], [0.0, 0.37113, 0.00813, -0.09556], [1.0, 0.49766, 0.00824, -0.09857], [2.0, 0.62334, 0.00842, -0.10139], [3.0, 0.74798, 0.00867, -0.10403], [4.0, 0.87137, 0.00901, -0.10645], [5.0, 0.9932, 0.00945, -0.10863], [6.0, 1.11325, 0.00998, -0.11057], [7.0, 1.23037, 0.0107, -0.11214], [8.0, 1.34496, 0.01153, -0.11337], [9.0, 1.45407, 0.01269, -0.11396], [10.0, 1.55911, 0.01396, -0.11403], [11.0, 1.65779, 0.01545, -0.11336], [12.0, 1.74834, 0.01724, -0.11187], [13.0, 1.82666, 0.01961, -0.10935], [14.0, 1.88831, 0.02293, -0.10606], [15.0, 1.92579, 0.02795, -0.10238], [16.0, 1.92722, 0.03609, -0.09887], [18.0, 1.80055, 0.06534, -0.09497], [20.0, 1.63088, 0.10459, -0.09996], [24.0, 1.43345, 0.19148, -0.12589], [28.0, 1.28805, 0.28629, -0.15453], [32.0, 1.16356, 0.3946, -0.18396], [36.1429, 1.11321, 0.49645, -0.21099], [40.2857, 1.06444, 0.60319, -0.23768], [44.4286, 1.01259, 0.71263, -0.25992], [48.5714, 0.95478, 0.82249, -0.28216], [52.7143, 0.88932, 0.93051, -0.30323], [56.8571, 0.81542, 1.03447, -0.32368], [61.0, 0.73296, 1.13222, -0.3438], [65.1429, 0.64236, 1.22176, -0.36292], [69.2857, 0.5445, 1.30123, -0.38204], [73.4286, 0.44065, 1.36903, -0.39944], [77.5714, 0.33237, 1.42376, -0.41648], [81.7143, 0.22148, 1.46433, -0.43231], [85.8571, 0.10997, 1.4899, -0.44643], [90.0, 0.0, 1.5, -0.46055], [94.1429, -0.07698, 1.4899, -0.46732], [98.2857, -0.15503, 1.46433, -0.47409], [102.4286, -0.23266, 1.42376, -0.47695], [106.5714, -0.30846, 1.36903, -0.47705], [110.7143, -0.38115, 1.30123, -0.47627], [114.8571, -0.44965, 1.22176, -0.4713], [119.0, -0.51307, 1.13222, -0.46633], [123.1429, -0.5708, 1.03447, -0.4602], [127.2857, -0.62253, 0.93051, -0.4537], [131.4286, -0.66835, 0.82249, -0.44858], [135.5714, -0.70881, 0.71263, -0.44609], [139.7143, -0.74511, 0.60319, -0.4436], [143.8571, -0.77925, 0.49645, -0.44436], [148.0, -0.81449, 0.3946, -0.44537], [150.2857, -0.75631, 0.34128, -0.44368], [152.5714, -0.69814, 0.29043, -0.42628], [154.8571, -0.63996, 0.24237, -0.40888], [157.1429, -0.58178, 0.1974, -0.39148], [159.4286, -0.5236, 0.15581, -0.37408], [161.7143, -0.46542, 0.11786, -0.39207], [164.0, -0.40725, 0.08379, -0.42184], [166.2857, -0.34907, 0.05382, -0.45162], [168.5714, -0.29089, 0.02922, -0.48139], [170.8571, -0.23271, 0.023, -0.45714], [173.1429, -0.17453, 0.01811, -0.34286], [175.4286, -0.11636, 0.0146, -0.22857], [177.7143, -0.05818, 0.01248, -0.11429], [179.9087, 0.0, 0.01178, 0.0]]

turbine['airfoils'][4]['name'] = 'FFA-W3-270blend'
turbine['airfoils'][4]['relative_thickness'] = 0.27
turbine['airfoils'][4]['data'] = [[-179.9087, 0.0, 0.01545, 0.0], [-177.7143, 0.06213, 0.01611, 0.09143], [-175.4286, 0.12426, 0.01807, 0.18286], [-173.1429, 0.18639, 0.02133, 0.27429], [-170.8572, 0.24852, 0.02587, 0.36571], [-168.5716, 0.31064, 0.03289, 0.39874], [-166.2857, 0.37277, 0.05681, 0.39672], [-164.0, 0.4349, 0.08471, 0.3947], [-161.7145, 0.49703, 0.11643, 0.39268], [-159.4284, 0.55916, 0.15176, 0.39544], [-157.1428, 0.62129, 0.19048, 0.41254], [-154.8573, 0.68342, 0.23234, 0.42964], [-152.5714, 0.74555, 0.27708, 0.44674], [-150.2857, 0.80768, 0.32441, 0.46384], [-148.0, 0.86981, 0.37404, 0.46186], [-143.8571, 0.8166, 0.46882, 0.45335], [-139.7143, 0.76812, 0.56814, 0.44523], [-135.5714, 0.7204, 0.66995, 0.44237], [-131.4286, 0.67095, 0.77214, 0.43951], [-127.2857, 0.61828, 0.87258, 0.44072], [-123.1429, 0.56158, 0.96921, 0.44407], [-119.0, 0.50057, 1.06002, 0.44739], [-114.8571, 0.4354, 1.14315, 0.45063], [-110.7143, 0.36655, 1.21688, 0.45387], [-106.5714, 0.29475, 1.27969, 0.45377], [-102.4286, 0.22098, 1.3303, 0.45298], [-98.2857, 0.14639, 1.36768, 0.44973], [-94.1429, 0.07227, 1.39107, 0.44302], [-90.0, 0.0, 1.4, 0.4363], [-85.8571, -0.07227, 1.39107, 0.4218], [-81.7143, -0.14639, 1.36768, 0.4073], [-77.5714, -0.22098, 1.3303, 0.3902], [-73.4286, -0.29475, 1.27969, 0.37125], [-69.2857, -0.36655, 1.21688, 0.3519], [-65.1429, -0.4354, 1.14315, 0.33068], [-61.0, -0.50057, 1.06002, 0.30945], [-56.8571, -0.56158, 0.96921, 0.28815], [-52.7143, -0.61828, 0.87258, 0.26684], [-48.5714, -0.67095, 0.77214, 0.24576], [-44.4286, -0.7204, 0.66995, 0.22512], [-40.2857, -0.76812, 0.56814, 0.20447], [-36.1429, -0.8166, 0.46882, 0.13957], [-32.0, -0.86981, 0.37404, 0.07138], [-28.0, -1.09837, 0.2188, 0.044], [-24.0, -1.08339, 0.15982, 0.02166], [-20.0, -1.0699, 0.10744, 0.00422], [-18.0, -1.05454, 0.0869, -0.00035], [-16.0, -1.03432, 0.06844, -0.00334], [-14.0, -1.0836, 0.04733, -0.00283], [-12.0, -1.09489, 0.03085, -0.00556], [-10.0, -0.92665, 0.01984, -0.02952], [-8.0, -0.69676, 0.01439, -0.04822], [-6.0, -0.43628, 0.01155, -0.06483], [-4.0, -0.16252, 0.01026, -0.07919], [-2.0, 0.10709, 0.00976, -0.09041], [-1.0, 0.23993, 0.00967, -0.09517], [0.0, 0.37158, 0.00968, -0.09953], [1.0, 0.5021, 0.00976, -0.10355], [2.0, 0.63139, 0.00993, -0.10725], [3.0, 0.75951, 0.01016, -0.11068], [4.0, 0.88638, 0.01045, -0.11385], [5.0, 1.01172, 0.01082, -0.11673], [6.0, 1.1343, 0.0114, -0.11923], [7.0, 1.25536, 0.01198, -0.12145], [8.0, 1.37379, 0.01267, -0.12328], [9.0, 1.48841, 0.01353, -0.1246], [10.0, 1.59782, 0.0146, -0.12526], [11.0, 1.70005, 0.01597, -0.12505], [12.0, 1.7919, 0.01777, -0.1237], [13.0, 1.86782, 0.02035, -0.12093], [14.0, 1.92687, 0.02385, -0.11725], [15.0, 1.90901, 0.03236, -0.10931], [16.0, 1.88548, 0.04259, -0.10525], [18.0, 1.72106, 0.07672, -0.10292], [20.0, 1.54737, 0.11914, -0.11017], [24.0, 1.37176, 0.20189, -0.13431], [28.0, 1.33611, 0.27981, -0.15777], [32.0, 1.24258, 0.37404, -0.18432], [36.1429, 1.16657, 0.46882, -0.21002], [40.2857, 1.09731, 0.56814, -0.23531], [44.4286, 1.02914, 0.66995, -0.25508], [48.5714, 0.9585, 0.77214, -0.27485], [52.7143, 0.88325, 0.87258, -0.29346], [56.8571, 0.80225, 0.96921, -0.31145], [61.0, 0.7151, 1.06002, -0.32925], [65.1429, 0.622, 1.14315, -0.34641], [69.2857, 0.52364, 1.21688, -0.36357], [73.4286, 0.42107, 1.27969, -0.37949], [77.5714, 0.31569, 1.3303, -0.39517], [81.7143, 0.20913, 1.36768, -0.40983], [85.8571, 0.10324, 1.39107, -0.42306], [90.0, 0.0, 1.4, -0.4363], [94.1429, -0.07227, 1.39107, -0.44302], [98.2857, -0.14639, 1.36768, -0.44973], [102.4286, -0.22098, 1.3303, -0.45298], [106.5714, -0.29475, 1.27969, -0.45377], [110.7143, -0.36655, 1.21688, -0.45387], [114.8571, -0.4354, 1.14315, -0.45063], [119.0, -0.50057, 1.06002, -0.44739], [123.1429, -0.56158, 0.96921, -0.44407], [127.2857, -0.61828, 0.87258, -0.44072], [131.4286, -0.67095, 0.77214, -0.43951], [135.5714, -0.7204, 0.66995, -0.44237], [139.7143, -0.76812, 0.56814, -0.44523], [143.8571, -0.8166, 0.46882, -0.45335], [148.0, -0.86981, 0.37404, -0.46186], [150.2857, -0.80768, 0.32441, -0.46384], [152.5714, -0.74555, 0.27708, -0.44674], [154.8571, -0.68342, 0.23234, -0.42964], [157.1429, -0.62129, 0.19048, -0.41254], [159.4286, -0.55916, 0.15176, -0.39544], [161.7143, -0.49703, 0.11643, -0.40982], [164.0, -0.4349, 0.08471, -0.4347], [166.2857, -0.37277, 0.05681, -0.45958], [168.5714, -0.31064, 0.03289, -0.48445], [170.8571, -0.24852, 0.02587, -0.45714], [173.1429, -0.18639, 0.02133, -0.34286], [175.4286, -0.12426, 0.01807, -0.22857], [177.7143, -0.06213, 0.01611, -0.11429], [179.9087, 0.0, 0.01545, 0.0]]

turbine['airfoils'][5]['name'] = 'FFA-W3-301'
turbine['airfoils'][5]['relative_thickness'] = 0.301
turbine['airfoils'][5]['data'] = [[-179.9087, 0.0, 0.02454, 0.0], [-177.7143, 0.06508, 0.02514, 0.09143], [-175.4286, 0.13016, 0.02694, 0.18286], [-173.1429, 0.19525, 0.02993, 0.27429], [-170.8572, 0.26033, 0.03408, 0.36571], [-168.5716, 0.32541, 0.03938, 0.40085], [-166.2857, 0.39049, 0.0591, 0.4022], [-164.0, 0.45557, 0.08495, 0.40356], [-161.7145, 0.52066, 0.11433, 0.40492], [-159.4284, 0.58574, 0.14704, 0.4101], [-157.1428, 0.65082, 0.1829, 0.42678], [-154.8573, 0.7159, 0.22166, 0.44345], [-152.5714, 0.78098, 0.26309, 0.46013], [-150.2857, 0.84607, 0.30692, 0.4768], [-148.0, 0.91115, 0.35287, 0.47162], [-143.8571, 0.84257, 0.44061, 0.45656], [-139.7143, 0.78187, 0.53255, 0.44202], [-135.5714, 0.72448, 0.62677, 0.43452], [-131.4286, 0.66755, 0.72131, 0.42701], [-127.2857, 0.60928, 0.81421, 0.42483], [-123.1429, 0.54868, 0.90355, 0.42544], [-119.0, 0.4853, 0.98748, 0.42634], [-114.8571, 0.41915, 1.06425, 0.42813], [-110.7143, 0.35056, 1.13227, 0.42992], [-106.5714, 0.28017, 1.19015, 0.42916], [-102.4286, 0.20881, 1.23669, 0.42788], [-98.2857, 0.13754, 1.27093, 0.42444], [-94.1429, 0.06751, 1.29218, 0.41794], [-90.0, 0.0, 1.3, 0.41144], [-85.8571, -0.06751, 1.29218, 0.39804], [-81.7143, -0.13754, 1.27093, 0.38464], [-77.5714, -0.20881, 1.23669, 0.36892], [-73.4286, -0.28017, 1.19015, 0.35157], [-69.2857, -0.35056, 1.13227, 0.33391], [-65.1429, -0.41915, 1.06425, 0.31474], [-61.0, -0.4853, 0.98748, 0.29557], [-56.8571, -0.54868, 0.90355, 0.27653], [-52.7143, -0.60928, 0.81421, 0.25754], [-48.5714, -0.66755, 0.72131, 0.23873], [-44.4286, -0.72448, 0.62677, 0.22027], [-40.2857, -0.78187, 0.53255, 0.20181], [-36.1429, -0.84257, 0.44061, 0.13644], [-32.0, -0.91115, 0.35287, 0.0676], [-28.0, -1.10349, 0.21721, 0.04231], [-24.0, -1.10737, 0.15629, 0.02026], [-20.0, -1.11815, 0.10335, 0.00407], [-18.0, -1.12332, 0.0818, 0.00017], [-16.0, -1.11865, 0.06331, -0.00167], [-14.0, -1.1162, 0.04718, -0.0012], [-12.0, -1.09588, 0.0328, -0.00463], [-10.0, -0.91767, 0.02351, -0.02494], [-8.0, -0.69311, 0.01793, -0.04304], [-6.0, -0.45396, 0.01431, -0.05868], [-4.0, -0.17779, 0.01242, -0.07601], [-2.0, 0.1048, 0.0116, -0.09121], [-1.0, 0.24383, 0.01143, -0.09763], [0.0, 0.38111, 0.01138, -0.10341], [1.0, 0.5166, 0.01143, -0.10861], [2.0, 0.65044, 0.01156, -0.11333], [3.0, 0.78267, 0.01177, -0.11762], [4.0, 0.91326, 0.01204, -0.12154], [5.0, 1.04207, 0.01239, -0.1251], [6.0, 1.16873, 0.01283, -0.12828], [7.0, 1.29296, 0.01338, -0.13104], [8.0, 1.4139, 0.01406, -0.13332], [9.0, 1.53088, 0.01488, -0.13503], [10.0, 1.64208, 0.01592, -0.13599], [11.0, 1.74568, 0.01726, -0.13605], [12.0, 1.83887, 0.01908, -0.13514], [13.0, 1.91764, 0.02169, -0.13322], [14.0, 1.97413, 0.02572, -0.1302], [15.0, 1.99916, 0.03222, -0.12641], [16.0, 1.99377, 0.04157, -0.12265], [18.0, 1.9172, 0.06731, -0.11675], [20.0, 1.73683, 0.10526, -0.11652], [24.0, 1.47321, 0.19229, -0.1379], [28.0, 1.36017, 0.27449, -0.16242], [32.0, 1.30164, 0.35287, -0.18463], [36.1429, 1.20367, 0.44061, -0.20894], [40.2857, 1.11695, 0.53255, -0.23276], [44.4286, 1.03498, 0.62677, -0.25011], [48.5714, 0.95364, 0.72131, -0.26746], [52.7143, 0.8704, 0.81421, -0.28365], [56.8571, 0.78383, 0.90355, -0.29923], [61.0, 0.69329, 0.98748, -0.31472], [65.1429, 0.59878, 1.06425, -0.32988], [69.2857, 0.5008, 1.13227, -0.34505], [73.4286, 0.40024, 1.19015, -0.35942], [77.5714, 0.29831, 1.23669, -0.37363], [81.7143, 0.19648, 1.27093, -0.38702], [85.8571, 0.09644, 1.29218, -0.39923], [90.0, 0.0, 1.3, -0.41144], [94.1429, -0.06751, 1.29218, -0.41794], [98.2857, -0.13754, 1.27093, -0.42444], [102.4286, -0.20881, 1.23669, -0.42788], [106.5714, -0.28017, 1.19015, -0.42916], [110.7143, -0.35056, 1.13227, -0.42992], [114.8571, -0.41915, 1.06425, -0.42813], [119.0, -0.4853, 0.98748, -0.42634], [123.1429, -0.54868, 0.90355, -0.42544], [127.2857, -0.60928, 0.81421, -0.42483], [131.4286, -0.66755, 0.72131, -0.42701], [135.5714, -0.72448, 0.62677, -0.43452], [139.7143, -0.78187, 0.53255, -0.44202], [143.8571, -0.84257, 0.44061, -0.45656], [148.0, -0.91115, 0.35287, -0.47162], [150.2857, -0.84607, 0.30692, -0.4768], [152.5714, -0.78098, 0.26309, -0.46013], [154.8571, -0.7159, 0.22166, -0.44345], [157.1429, -0.65082, 0.1829, -0.42678], [159.4286, -0.58574, 0.14704, -0.4101], [161.7143, -0.52066, 0.11433, -0.42206], [164.0, -0.45557, 0.08495, -0.44356], [166.2857, -0.39049, 0.0591, -0.46506], [168.5714, -0.32541, 0.03938, -0.48656], [170.8571, -0.26033, 0.03408, -0.45714], [173.1429, -0.19525, 0.02993, -0.34286], [175.4286, -0.13016, 0.02694, -0.22857], [177.7143, -0.06508, 0.02514, -0.11429], [179.9087, 0.0, 0.02454, 0.0]]

turbine['airfoils'][6]['name'] = 'FFA-W3-330blend'
turbine['airfoils'][6]['relative_thickness'] = 0.33
turbine['airfoils'][6]['data'] = [[-179.9087, 0.0, 0.03169, 0.0], [-177.7143, 0.0696, 0.03228, 0.09143], [-175.4286, 0.1392, 0.03406, 0.18286], [-173.1429, 0.2088, 0.03702, 0.27429], [-170.8572, 0.27841, 0.04114, 0.36571], [-168.5716, 0.34801, 0.04638, 0.40308], [-166.2857, 0.41761, 0.05732, 0.40801], [-164.0, 0.48721, 0.08319, 0.41294], [-161.7145, 0.55681, 0.11258, 0.41788], [-159.4284, 0.62641, 0.14533, 0.42586], [-157.1428, 0.69601, 0.18121, 0.44302], [-154.8573, 0.76562, 0.22, 0.46017], [-152.5714, 0.83522, 0.26146, 0.47732], [-150.2857, 0.90482, 0.30532, 0.49447], [-148.0, 0.97442, 0.35131, 0.48743], [-143.8571, 0.89412, 0.43913, 0.46839], [-139.7143, 0.82382, 0.53115, 0.44996], [-135.5714, 0.75845, 0.62546, 0.43985], [-131.4286, 0.69477, 0.7201, 0.42974], [-127.2857, 0.63079, 0.8131, 0.42589], [-123.1429, 0.56532, 0.90255, 0.42535], [-119.0, 0.49783, 0.98659, 0.42528], [-114.8571, 0.42823, 1.06348, 0.42673], [-110.7143, 0.3568, 1.13162, 0.42817], [-106.5714, 0.28412, 1.18963, 0.42745], [-102.4286, 0.21103, 1.23629, 0.42628], [-98.2857, 0.13851, 1.27067, 0.42303], [-94.1429, 0.06775, 1.29204, 0.41683], [-90.0, 0.0, 1.3, 0.41063], [-85.8571, -0.06775, 1.29204, 0.39752], [-81.7143, -0.13851, 1.27067, 0.38441], [-77.5714, -0.21103, 1.23629, 0.36905], [-73.4286, -0.28412, 1.18963, 0.35212], [-69.2857, -0.3568, 1.13162, 0.33491], [-65.1429, -0.42823, 1.06348, 0.31634], [-61.0, -0.49783, 0.98659, 0.29777], [-56.8571, -0.56532, 0.90255, 0.27947], [-52.7143, -0.63079, 0.8131, 0.26125], [-48.5714, -0.69477, 0.7201, 0.24322], [-44.4286, -0.75845, 0.62546, 0.22556], [-40.2857, -0.82382, 0.53115, 0.20789], [-36.1429, -0.89412, 0.43913, 0.13731], [-32.0, -0.97442, 0.35131, 0.0628], [-28.0, -1.16308, 0.20648, 0.03905], [-24.0, -1.14892, 0.15001, 0.01853], [-20.0, -1.09451, 0.106, 0.00441], [-18.0, -1.05801, 0.08732, -0.00061], [-16.0, -1.02281, 0.07051, -0.00342], [-14.0, -0.9981, 0.05474, -0.00401], [-12.0, -0.98515, 0.04052, -0.00272], [-10.0, -0.89583, 0.02929, -0.01198], [-8.0, -0.67539, 0.02207, -0.03458], [-6.0, -0.43247, 0.01735, -0.05466], [-4.0, -0.15881, 0.01473, -0.07425], [-2.0, 0.13456, 0.01362, -0.0927], [-1.0, 0.28014, 0.01339, -0.10074], [0.0, 0.42386, 0.0133, -0.10802], [1.0, 0.56519, 0.01333, -0.1145], [2.0, 0.7041, 0.01345, -0.12028], [3.0, 0.84071, 0.01366, -0.12546], [4.0, 0.975, 0.01397, -0.13011], [5.0, 1.1068, 0.01437, -0.13425], [6.0, 1.23603, 0.01486, -0.13793], [7.0, 1.36223, 0.01547, -0.14108], [8.0, 1.48424, 0.01623, -0.14363], [9.0, 1.60097, 0.01718, -0.14545], [10.0, 1.7101, 0.01841, -0.14636], [11.0, 1.80957, 0.0201, -0.14635], [12.0, 1.89473, 0.02258, -0.14544], [13.0, 1.95698, 0.02671, -0.14378], [14.0, 1.98576, 0.0338, -0.14185], [15.0, 1.9926, 0.04333, -0.14004], [16.0, 1.99617, 0.05354, -0.13823], [18.0, 1.96398, 0.07706, -0.13351], [20.0, 1.81179, 0.11169, -0.13135], [24.0, 1.56073, 0.19103, -0.1466], [28.0, 1.46798, 0.27199, -0.17242], [32.0, 1.39203, 0.35131, -0.19417], [36.1429, 1.27731, 0.43913, -0.21792], [40.2857, 1.17689, 0.53115, -0.24115], [44.4286, 1.0835, 0.62546, -0.25734], [48.5714, 0.99253, 0.7201, -0.27354], [52.7143, 0.90112, 0.8131, -0.28862], [56.8571, 0.8076, 0.90255, -0.30311], [61.0, 0.71119, 0.98659, -0.31757], [65.1429, 0.61175, 1.06348, -0.33194], [69.2857, 0.50971, 1.13162, -0.34631], [73.4286, 0.40589, 1.18963, -0.36014], [77.5714, 0.30146, 1.23629, -0.37385], [81.7143, 0.19788, 1.27067, -0.38681], [85.8571, 0.09679, 1.29204, -0.39872], [90.0, 0.0, 1.3, -0.41063], [94.1429, -0.06775, 1.29204, -0.41683], [98.2857, -0.13851, 1.27067, -0.42303], [102.4286, -0.21103, 1.23629, -0.42628], [106.5714, -0.28412, 1.18963, -0.42745], [110.7143, -0.3568, 1.13162, -0.42817], [114.8571, -0.42823, 1.06348, -0.42673], [119.0, -0.49783, 0.98659, -0.42528], [123.1429, -0.56532, 0.90255, -0.42535], [127.2857, -0.63079, 0.8131, -0.42589], [131.4286, -0.69477, 0.7201, -0.42974], [135.5714, -0.75845, 0.62546, -0.43985], [139.7143, -0.82382, 0.53115, -0.44996], [143.8571, -0.89412, 0.43913, -0.46839], [148.0, -0.97442, 0.35131, -0.48743], [150.2857, -0.90482, 0.30532, -0.49447], [152.5714, -0.83522, 0.26146, -0.47732], [154.8571, -0.76562, 0.22, -0.46017], [157.1429, -0.69601, 0.18121, -0.44302], [159.4286, -0.62641, 0.14533, -0.42586], [161.7143, -0.55681, 0.11258, -0.43502], [164.0, -0.48721, 0.08319, -0.45294], [166.2857, -0.41761, 0.05732, -0.47087], [168.5714, -0.34801, 0.04638, -0.4888], [170.8571, -0.27841, 0.04114, -0.45714], [173.1429, -0.2088, 0.03702, -0.34286], [175.4286, -0.1392, 0.03406, -0.22857], [177.7143, -0.0696, 0.03228, -0.11429], [179.9087, 0.0, 0.03169, 0.0]]

turbine['airfoils'][7]['name'] = 'FFA-W3-360'
turbine['airfoils'][7]['relative_thickness'] = 0.36
turbine['airfoils'][7]['data'] = [[-179.9087, 0.0, 0.03715, 0.0], [-177.7143, 0.07178, 0.03774, 0.09143], [-175.4286, 0.14356, 0.03951, 0.18286], [-173.1429, 0.21534, 0.04245, 0.27429], [-170.8572, 0.28713, 0.04653, 0.36571], [-168.5716, 0.35891, 0.05174, 0.40313], [-166.2857, 0.43069, 0.06068, 0.40814], [-164.0, 0.50247, 0.08651, 0.41315], [-161.7145, 0.57425, 0.11586, 0.41816], [-159.4284, 0.64603, 0.14856, 0.42627], [-157.1428, 0.71781, 0.18439, 0.4437], [-154.8573, 0.7896, 0.22313, 0.46114], [-152.5714, 0.86138, 0.26453, 0.47857], [-150.2857, 0.93316, 0.30832, 0.496], [-148.0, 1.00494, 0.35424, 0.4883], [-143.8571, 0.91898, 0.44192, 0.46784], [-139.7143, 0.84406, 0.53379, 0.44803], [-135.5714, 0.77483, 0.62793, 0.43697], [-131.4286, 0.7079, 0.72238, 0.42591], [-127.2857, 0.64116, 0.8152, 0.4215], [-123.1429, 0.57335, 0.90444, 0.42058], [-119.0, 0.50388, 0.98826, 0.42024], [-114.8571, 0.43261, 1.06493, 0.42168], [-110.7143, 0.35981, 1.13285, 0.42312], [-106.5714, 0.28603, 1.19061, 0.42258], [-102.4286, 0.21209, 1.23704, 0.42163], [-98.2857, 0.13899, 1.27116, 0.41864], [-94.1429, 0.06787, 1.29229, 0.41277], [-90.0, 0.0, 1.3, 0.4069], [-85.8571, -0.06787, 1.29229, 0.39426], [-81.7143, -0.13899, 1.27116, 0.38162], [-77.5714, -0.21209, 1.23704, 0.36676], [-73.4286, -0.28603, 1.19061, 0.35033], [-69.2857, -0.35981, 1.13285, 0.33362], [-65.1429, -0.43261, 1.06493, 0.31561], [-61.0, -0.50388, 0.98826, 0.29759], [-56.8571, -0.57335, 0.90444, 0.27989], [-52.7143, -0.64116, 0.8152, 0.2623], [-48.5714, -0.7079, 0.72238, 0.24491], [-44.4286, -0.77483, 0.62793, 0.22794], [-40.2857, -0.84406, 0.53379, 0.21097], [-36.1429, -0.91898, 0.44192, 0.13525], [-32.0, -1.00494, 0.35424, 0.05517], [-28.0, -1.11306, 0.20494, 0.03211], [-24.0, -1.05425, 0.15434, 0.01268], [-20.0, -0.98247, 0.10967, -0.00282], [-18.0, -0.94173, 0.09249, -0.00741], [-16.0, -0.89333, 0.07597, -0.01107], [-14.0, -0.85472, 0.06054, -0.0125], [-12.0, -0.82348, 0.04641, -0.01177], [-10.0, -0.79541, 0.03441, -0.01082], [-8.0, -0.6365, 0.02548, -0.02769], [-6.0, -0.39095, 0.01994, -0.05107], [-4.0, -0.13071, 0.01653, -0.07148], [-2.0, 0.16173, 0.01507, -0.09179], [-1.0, 0.31121, 0.01477, -0.10119], [0.0, 0.45956, 0.01465, -0.10988], [1.0, 0.60566, 0.01466, -0.11776], [2.0, 0.74868, 0.01481, -0.12477], [3.0, 0.88862, 0.01507, -0.13098], [4.0, 1.02544, 0.01544, -0.13648], [5.0, 1.15878, 0.01593, -0.1413], [6.0, 1.28822, 0.01654, -0.1454], [7.0, 1.41282, 0.01731, -0.14875], [8.0, 1.5309, 0.01831, -0.15118], [9.0, 1.64065, 0.01963, -0.15262], [10.0, 1.73926, 0.0215, -0.1531], [11.0, 1.81971, 0.02445, -0.15254], [12.0, 1.87065, 0.02966, -0.15121], [13.0, 1.89221, 0.0377, -0.14969], [14.0, 1.8791, 0.04824, -0.14562], [15.0, 1.88111, 0.05838, -0.14358], [16.0, 1.86359, 0.06992, -0.14095], [18.0, 1.73324, 0.10166, -0.13711], [20.0, 1.59357, 0.13916, -0.14082], [24.0, 1.46708, 0.21002, -0.15693], [28.0, 1.44834, 0.282, -0.17979], [32.0, 1.43563, 0.35424, -0.20147], [36.1429, 1.31283, 0.44192, -0.22409], [40.2857, 1.2058, 0.53379, -0.24619], [44.4286, 1.1069, 0.62793, -0.26133], [48.5714, 1.01129, 0.72238, -0.27648], [52.7143, 0.91594, 0.8152, -0.29062], [56.8571, 0.81907, 0.90444, -0.30424], [61.0, 0.71982, 0.98826, -0.31787], [65.1429, 0.61801, 1.06493, -0.33154], [69.2857, 0.51401, 1.13285, -0.34522], [73.4286, 0.40862, 1.19061, -0.35846], [77.5714, 0.30299, 1.23704, -0.37161], [81.7143, 0.19855, 1.27116, -0.38405], [85.8571, 0.09695, 1.29229, -0.39547], [90.0, 0.0, 1.3, -0.4069], [94.1429, -0.06787, 1.29229, -0.41277], [98.2857, -0.13899, 1.27116, -0.41864], [102.4286, -0.21209, 1.23704, -0.42163], [106.5714, -0.28603, 1.19061, -0.42258], [110.7143, -0.35981, 1.13285, -0.42312], [114.8571, -0.43261, 1.06493, -0.42168], [119.0, -0.50388, 0.98826, -0.42024], [123.1429, -0.57335, 0.90444, -0.42058], [127.2857, -0.64116, 0.8152, -0.4215], [131.4286, -0.7079, 0.72238, -0.42591], [135.5714, -0.77483, 0.62793, -0.43697], [139.7143, -0.84406, 0.53379, -0.44803], [143.8571, -0.91898, 0.44192, -0.46784], [148.0, -1.00494, 0.35424, -0.4883], [150.2857, -0.93316, 0.30832, -0.496], [152.5714, -0.86138, 0.26453, -0.47857], [154.8571, -0.7896, 0.22313, -0.46114], [157.1429, -0.71781, 0.18439, -0.4437], [159.4286, -0.64603, 0.14856, -0.42627], [161.7143, -0.57425, 0.11586, -0.4353], [164.0, -0.50247, 0.08651, -0.45315], [166.2857, -0.43069, 0.06068, -0.471], [168.5714, -0.35891, 0.05174, -0.48884], [170.8571, -0.28713, 0.04653, -0.45714], [173.1429, -0.21534, 0.04245, -0.34286], [175.4286, -0.14356, 0.03951, -0.22857], [177.7143, -0.07178, 0.03774, -0.11429], [179.9087, 0.0, 0.03715, 0.0]]

# control
turbine['pitch_control'] = {}
turbine['pitch_control']['GS_Angles'] = [0.06019804, 0.08713416, 0.10844806, 0.12685912, 0.14339822, 0.1586021, 0.17279614, 0.18618935, 0.19892772, 0.21111989, 0.22285021, 0.23417256, 0.2451469, 0.25580691, 0.26619545, 0.27632495, 0.28623134, 0.29593266, 0.30544521, 0.314779, 0.32395154, 0.33297489, 0.3418577, 0.35060844, 0.35923641, 0.36774807, 0.37614942, 0.38444655, 0.39264363, 0.40074407]
turbine['pitch_control']['GS_Kp'] = [-0.9394215, -0.80602855, -0.69555026, -0.60254912, -0.52318192, -0.45465531, -0.39489024, -0.34230736, -0.29568537, -0.25406506, -0.2166825, -0.18292183, -0.15228099, -0.12434663, -0.09877533, -0.0752794, -0.05361604, -0.0335789, -0.01499149, 0.00229803, 0.01842102, 0.03349169, 0.0476098, 0.0608629, 0.07332812, 0.0850737, 0.0961602, 0.10664158, 0.11656607, 0.12597691]
turbine['pitch_control']['GS_Ki'] = [-0.07416547, -0.06719673, -0.0614251, -0.05656651, -0.0524202, -0.04884022, -0.04571796, -0.04297091, -0.04053528, -0.03836094, -0.03640799, -0.03464426, -0.03304352, -0.03158417, -0.03024826, -0.02902079, -0.02788904, -0.02684226, -0.02587121, -0.02496797, -0.02412567, -0.02333834, -0.02260078, -0.02190841, -0.0212572, -0.02064359, -0.0200644, -0.01951683, -0.01899836, -0.01850671]
turbine['pitch_control']['Fl_Kp'] = -9.35

turbine['wt_ops'] = [{} for _ in range(3) ]
turbine['wt_ops'][0]['v'] = [3.0, 3.266896551724138, 3.533793103448276, 3.800689655172414, 4.067586206896552, 4.334482758620689, 4.601379310344828, 4.868275862068966, 5.135172413793104, 5.402068965517241, 5.6689655172413795, 5.935862068965518, 6.2027586206896554, 6.469655172413793, 6.736551724137931, 7.00344827586207, 7.270344827586207, 7.537241379310345, 7.804137931034483, 8.071034482758622, 8.337931034482759, 8.604827586206897, 8.871724137931036, 9.138620689655173, 9.405517241379311, 9.672413793103448, 9.939310344827586, 10.206206896551725, 10.473103448275863, 10.74, 11.231724137931035, 11.723448275862069, 12.215172413793104, 12.706896551724139, 13.198620689655172, 13.690344827586207, 14.182068965517242, 14.673793103448276, 15.16551724137931, 15.657241379310346, 16.14896551724138, 16.640689655172416, 17.13241379310345, 17.624137931034483, 18.11586206896552, 18.607586206896553, 19.099310344827586, 19.591034482758623, 20.082758620689653, 20.57448275862069, 21.066206896551726, 21.557931034482756, 22.049655172413793, 22.54137931034483, 23.03310344827586, 23.524827586206897, 24.016551724137933, 24.508275862068963, 25.0]
turbine['wt_ops'][0]['pitch_op'] = [-0.25, -0.25, -0.25, -0.25, -0.25, -0.25, -0.25, -0.25, -0.25, -0.25, -0.25, -0.25, -0.25, -0.25, -0.25, -0.25, -0.25, -0.25, -0.25, -0.25, -0.25, -0.25, -0.25, -0.25, -0.25, -0.25, -0.25, -0.25, -0.25, -0.25, 3.57152, 5.12896, 6.36736, 7.43866, 8.40197, 9.28843, 10.1161, 10.8974, 11.641, 12.3529, 13.038, 13.6997, 14.3409, 14.9642, 15.5713, 16.1639, 16.7435, 17.3109, 17.8673, 18.4136, 18.9506, 19.4788, 19.9989, 20.5112, 21.0164, 21.5147, 22.0067, 22.4925, 22.9724]
turbine['wt_ops'][0]['omega_op'] = [2.1486, 2.3397, 2.5309, 2.722, 2.9132, 3.1043, 3.2955, 3.4866, 3.6778, 3.8689, 4.0601, 4.2512, 4.4424, 4.6335, 4.8247, 5.0159, 5.207, 5.3982, 5.5893, 5.7805, 5.9716, 6.1628, 6.3539, 6.5451, 6.7362, 6.9274, 7.1185, 7.3097, 7.5008, 7.56, 7.56, 7.56, 7.56, 7.56, 7.56, 7.56, 7.56, 7.56, 7.56, 7.56, 7.56, 7.56, 7.56, 7.56, 7.56, 7.56, 7.56, 7.56, 7.56, 7.56, 7.56, 7.56, 7.56, 7.56, 7.56, 7.56, 7.56, 7.56, 7.56]

turbine['gear_ratio'] = 1

turbine['torque_control'] = {}
turbine['torque_control']['VS_KP'] = -38609162.66552
turbine['torque_control']['VS_KI'] = -4588245.1872

# tower
turbine['tower'] = [{} for _ in range(1)]
turbine['tower'][0]['dlsMax'] = 5.0
turbine['tower'][0]['name'] = 'tower'
turbine['tower'][0]['type'] = 1
turbine['tower'][0]['rA'] = [0, 0, 15]
turbine['tower'][0]['rB'] = [0, 0, 144.582]
turbine['tower'][0]['shape'] = 'circ'
turbine['tower'][0]['gamma'] = 0.0
turbine['tower'][0]['stations'] = [15, 28, 28.001, 41, 41.001, 54, 54.001, 67, 67.001, 80, 80.001, 93, 93.001, 106, 106.001, 119, 119.001, 132, 132.001, 144.582]
turbine['tower'][0]['d'] = [10, 9.964, 9.964, 9.967, 9.967, 9.927, 9.927, 9.528, 9.528, 9.149, 9.149, 8.945, 8.945, 8.735, 8.735, 8.405, 8.405, 7.321, 7.321, 6.5]
turbine['tower'][0]['t'] = [0.082954, 0.082954, 0.083073, 0.083073, 0.082799, 0.082799, 0.0299, 0.0299, 0.027842, 0.027842, 0.025567, 0.025567, 0.022854, 0.022854, 0.02025, 0.02025, 0.018339, 0.018339, 0.021211, 0.021211]
turbine['tower'][0]['Cd'] = 0.0
turbine['tower'][0]['Ca'] = 0.0
turbine['tower'][0]['CdEnd'] = 0.0
turbine['tower'][0]['CaEnd'] = 0.0
turbine['tower'][0]['rho_shell'] = 7850

design['turbine'] = turbine


## PLATFORM ##

nMembers = 2

shell_density = 8000
ballast_density = 1025

column_height = draft + freeboard

platform = {}
platform['potModMaster'] = 1
platform['dlsMax'] = 5.0


platform['members'] = [{} for _ in range(nMembers)]
platform['members'][0]['name'] = 'center_column'
platform['members'][0]['type'] = 2
platform['members'][0]['rA'] = [0, 0, -draft]
platform['members'][0]['rB'] = [0, 0, freeboard]
platform['members'][0]['shape'] = center_column_shape
platform['members'][0]['gamma'] = 0.0
platform['members'][0]['potMod'] = True
platform['members'][0]['stations'] = [0, column_height]
platform['members'][0]['d'] = column_diameter
platform['members'][0]['t'] = thickness
platform['members'][0]['Cd'] = 0.8
platform['members'][0]['Ca'] = 1.0
platform['members'][0]['CdEnd'] = 0.6
platform['members'][0]['CaEnd'] = 0.6
platform['members'][0]['rho_shell'] = 8000
platform['members'][0]['l_fill'] = ballast_fill
platform['members'][0]['rho_fill'] = ballast_density
platform['members'][0]['cap_stations'] = [0]
platform['members'][0]['cap_t'] = [thickness]
platform['members'][0]['cap_d_in'] = 0



headings = list(np.arange(0, 360, 360/pontoon_n) + 60)
radius = pontoon_length + column_diameter/2

platform['members'][1]['name'] = 'pontoon'
platform['members'][1]['type'] = 2
platform['members'][1]['heading'] = headings
platform['members'][1]['shape'] = pontoon_shape
platform['members'][1]['rA'] = np.array([column_diameter/2, 0, -draft+pontoon_dim/2])
platform['members'][1]['rB'] = np.array([column_diameter/2 + pontoon_length, 0, -draft+pontoon_dim/2])
platform['members'][1]['gamma'] = 0.0
platform['members'][1]['potMod'] = False
platform['members'][1]['stations'] = [0, pontoon_length]
if ((pontoon_shape=='circular') or (pontoon_shape=='circ')):
    platform['members'][1]['d'] = pontoon_dim
elif ((pontoon_shape=='rectangular') or (pontoon_shape=='rect')):
    platform['members'][1]['d'] = [pontoon_dim, pontoon_dim] ## only square
platform['members'][1]['Cd'] = 0.8
platform['members'][1]['Ca'] = 1.0
platform['members'][1]['CdEnd'] = 0.6
platform['members'][1]['CaEnd'] = 0.6
platform['members'][1]['t'] = thickness
platform['members'][1]['rho_shell'] = shell_density
platform['members'][1]['l_fill'] = 0.0
platform['members'][1]['rho_fill'] = ballast_density


design['platform'] = platform


## Mooring system
depth = depth


mooring = {}
mooring['water_depth'] = depth



anchor_type = 'suction'
pointList = []
nLines_pontoon = tether_n/len(headings)
for i in range(len(headings)):
    leg_num = i+1
    x = radius*np.cos(np.radians(headings[i]))
    y = radius*np.sin(np.radians(headings[i]))
    xadj = (pontoon_dim/2)*np.cos(np.radians(headings[i]-90))
    yadj = (pontoon_dim/2)*np.sin(np.radians(headings[i]-90))
    pointList.append({'name': f'leg{leg_num}_anchor1', 'type': 'fixed', 'location': [float(x+xadj), float(y+yadj), -depth], 'anchor_type': anchor_type})
    xadj = (pontoon_dim/2)*np.cos(np.radians(headings[i]+90))
    yadj = (pontoon_dim/2)*np.sin(np.radians(headings[i]+90))
    pointList.append({'name': f'leg{leg_num}_anchor2', 'type': 'fixed', 'location': [float(x+xadj), float(y+yadj), -depth], 'anchor_type': anchor_type})


for i in range(len(headings)):
    leg_num = i+1
    x = radius*np.cos(np.radians(headings[i]))
    y = radius*np.sin(np.radians(headings[i]))
    xadj = (pontoon_dim/2)*np.cos(np.radians(headings[i]-90))
    yadj = (pontoon_dim/2)*np.sin(np.radians(headings[i]-90))
    pointList.append({'name': f'leg{leg_num}_fairlead1', 'type': 'vessel', 'location': [float(x+xadj), float(y+yadj), -draft+(pontoon_dim/2)], 'anchor_type': anchor_type})
    xadj = (pontoon_dim/2)*np.cos(np.radians(headings[i]+90))
    yadj = (pontoon_dim/2)*np.sin(np.radians(headings[i]+90))
    pointList.append({'name': f'leg{leg_num}_fairlead2', 'type': 'vessel', 'location': [float(x+xadj), float(y+yadj), -draft+(pontoon_dim/2)], 'anchor_type': anchor_type})

mooring['points'] = pointList


lineList = []

for i in range(len(headings)):
    leg_num = i+1
    lineList.append({'name': f'leg{leg_num}_line1', 'endA': f'leg{leg_num}_anchor1', 'endB': f'leg{leg_num}_fairlead1', 'type': linetype, 'length': linelength})
    lineList.append({'name': f'leg{leg_num}_line2', 'endA': f'leg{leg_num}_anchor2', 'endB': f'leg{leg_num}_fairlead2', 'type': linetype, 'length': linelength})

mooring['lines'] = lineList


linetype_dict = mp.helpers.loadLineProps('default')[linetype]
m = linetype_dict['mass_d2']*(d/1000)**2
MBL = linetype_dict['MBL_0'] + linetype_dict['MBL_d']*(d/1000) + linetype_dict['MBL_d2']*(d/1000)**2 + linetype_dict['MBL_d3']*(d/1000)**3
EA = linetype_dict['EA_MBL']*MBL
mooring['line_types'] = [{'name': linetype, 'diameter': d/1000, 'mass_density': m, 'stiffness': EA, 'breaking_load': MBL, 
                                    'cost': 100, 'transverse_added_mass': 1.0, 'tangential_added_mass': 0.0, 'transverse_drag': 1.6, 'tangential_drag': 0.1}]


mooring['anchor_types'] = [{} for _ in range(1)]
mooring['anchor_types'][0]['name'] = 'suction'
mooring['anchor_types'][0]['mass'] = '1e3'
mooring['anchor_types'][0]['cost'] = '1e4'
mooring['anchor_types'][0]['max_vertical_load'] = '1e5'
mooring['anchor_types'][0]['max_lateral_load'] = 0.0

design['mooring'] = mooring



######################

print('\n')
model = raft.Model(design)
print('Analyzing in Unloaded Condition')
model.analyzeUnloaded()


fowt = model.fowtList[0]

pretension = fowt.ms.getForces(DOFtype='both', lines_only=True)
print(f'Pretension is: {pretension[2]: .2e} N')

displ = fowt.V*water_density - fowt.m + pretension[2]/g
heave = displ/(water_density*g*(np.pi/4)*column_diameter**2)
print(f'{heave:.2f}')

print('Checking Estimates for Natural Periods')
good = True
K1 = fowt.ms.getCoupledStiffnessA()[0,0]
M1 = fowt.M_struc[0,0] + fowt.A_hydro_morison[0,0]
if K1/M1 > 0:
    wn1 = np.sqrt(K1/M1)
    Tn1 = 2*np.pi/wn1
else:
    good = False
K3 = fowt.ms.getCoupledStiffnessA()[2,2] + fowt.C_hydro[2,2]
M3 = fowt.M_struc[2,2] + fowt.A_hydro_morison[2,2]
if K3/M3 > 0:
    wn3 = np.sqrt(K3/M3)
    Tn3 = 2*np.pi/wn3
else:
    good = False
K5 = fowt.ms.getCoupledStiffnessA()[4,4] + fowt.C_hydro[4,4] + fowt.C_struc[4,4] + water_density*g*(np.pi/4)*column_diameter**4
M5 = fowt.M_struc[4,4] + fowt.A_hydro_morison[4,4]
if K5/M5 > 0:
    wn5 = np.sqrt(K5/M5)
    Tn5 = 2*np.pi/wn5
else:
    good = False

if good==True:
    fns, modes = model.solveEigen()
    print(1/fns)
else:
    print('WARNING: One of the natural frequencies cannot be computed because there is a negative under the square root')




model.plot(hideGrid=False)
#plt.show()




######################


print('')
print('Modeling in MoorPy')
ms = mp.System()
ms.parseYAML(design['mooring'])

ms.bodyList[0].type = -1

ms.initialize()
ms.solveEquilibrium()

#fig, ax = ms.plot()

ms.bodyList[0].type = 0
ms.bodyList[0].m = fowt.m
ms.bodyList[0].v = fowt.V
ms.bodyList[0].rCG = fowt.rCG
ms.bodyList[0].AWP = fowt.AWP
ms.bodyList[0].rM = fowt.rM
ms.bodyList[0].I = np.array([fowt.props['Ixx'], fowt.props['Iyy'], fowt.props['Izz']])
ms.solveEquilibrium()

Fthrust = float(design['turbine']['Fthrust'])
hHub = float(design['turbine']['hHub'])
ms.bodyList[0].f6Ext = np.array([Fthrust, 0, 0, 0, 0, 0])
#ms.bodyList[0].f6Ext = np.array([2.15697204e+06, 2.40511390e+04, 2.37645091e+05, 3.53580845e+06, 3.40650113e+08, 7.50809930e+05])
ms.solveEquilibrium()
#fig, ax = ms.plot(ax=ax, color='red')

print('Offsets:')
print(f'    Surge = {ms.bodyList[0].r6[0]:.2f} m, Sway = {ms.bodyList[0].r6[1]:.2f}, Heave = {ms.bodyList[0].r6[2]:.2f} m')
print(f'    Roll = {ms.bodyList[0].r6[3]*(180/np.pi):.2f} deg, Pitch = {ms.bodyList[0].r6[4]*(180/np.pi):.2f} deg, Yaw = {ms.bodyList[0].r6[5]*(180/np.pi):.2f} deg')
print('Fairlead Tensions [N]:')
print(f'    x: Line1 = {ms.lineList[0].fB[0]:.2e}, Line2 = {ms.lineList[1].fB[0]:.2e}, Line3 = {ms.lineList[2].fB[0]:.2e}, Line4 = {ms.lineList[3].fB[0]:.2e}, Line5 = {ms.lineList[4].fB[0]:.2e}, Line6 = {ms.lineList[5].fB[0]:.2e}')
print(f'    z: Line1 = {ms.lineList[0].fB[2]:.2e}, Line2 = {ms.lineList[1].fB[2]:.2e}, Line3 = {ms.lineList[2].fB[2]:.2e}, Line4 = {ms.lineList[3].fB[2]:.2e}, Line5 = {ms.lineList[4].fB[2]:.2e}, Line6 = {ms.lineList[5].fB[2]:.2e}')
print('Constraint Checks:')
print(f'    Minimum Load Criteria: {fowt.V*water_density*g > (Fthrust*(hHub+draft)/radius) + fowt.m*g}')
print(f'        Buoyancy Force = {fowt.V*water_density*g:.2e} N; FtH/r + W = {(Fthrust*(hHub+draft)/radius) + fowt.m*g:.2e} N')
print(f'    Maximum Load Criteria: {np.max([np.linalg.norm(line.fB) for line in ms.lineList])   < 0.5*ms.lineList[0].type["MBL"]}')
print(f'        Maximum Tension = {np.max([np.linalg.norm(line.fB) for line in ms.lineList]):.2e} N @ Line {np.argmax([np.linalg.norm(line.fB) for line in ms.lineList])+1}, 0.5*MBL = {0.5*ms.lineList[0].type["MBL"]:.2e} N')

ms.plot()
plt.show()


######################


model.analyzeCases(display=1)


model.plot(hideGrid=False)
plt.show()








a = 2